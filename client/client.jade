//- ---------- -//
//-   GLOBAL   -//
//- ---------- -//

//- Head
head
  meta(http-equiv="X-UA-Compatible", content="IE=Edge")
  meta(charset="UTF-8")
  meta(name="viewport", content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no")
  meta(name="application-name", content="SpaiCheck")
  meta(name="description", content="SpaiCheck helps you catch spais!")
  title Spaicheck
//- Body
body
  #settings.ui.modal
    .header
      .ui.two.column.grid
        .column
          span Settings
        .right.aligned.column
          #settingsSaved.ui.label All settings saved
    .content
      #errTimeChk.ui.checkbox
        input(name="errTimeChk" type="checkbox")
        label Use EVE time format

//- --------- -//
//-  HELPERS  -//
//- --------- -//

//- Error
template(name="error")
  .tmpl-error
    span Whoops! We couldn't find what you were looking for...

//- Loading
template(name="loading")
  .tmpl-loading
    span Loading...

//- --------- -//
//-  LAYOUTS  -//
//- --------- -//

//- Landing
template(name="landing")
  header
    img.ui.image(src="logo.png")
    +loginButtons
  main
    a(href="{{pathFor 'home'}}")
      h2 Check for Spais!
  footer.ui.bottom.fixed.inverted.fluid.one.item.menu
    .item.header Running on Meteor

//- Dashboard
template(name="dashboard")
  aside#mobile-menu.ui.sidebar.thin.inverted.left.vertical.menu
    +Template.dynamic(template=side)
  .pusher
    aside#desktop-menu.ui.small.inverted.left.fixed.vertical.menu
      +Template.dynamic(template=side)
    #page-wrapper
      +Template.dynamic(template=head)
      +Template.dynamic(template=main)
      footer.ui.bottom.fixed.inverted.fluid.one.item.menu
        .item.header Running on Meteor

//- Dashboard Header
template(name="header")
  header.ui.fixed.top.inverted.menu
    .left.menu
      #side-toggle.ui.black.button &gt;&gt;
      a.item(href="{{pathFor 'home'}}")
        img.ui.tiny.image(src="/logo.png")
    .right.menu
      .ui.dropdown.item
        if currentUser
          img.ui.avatar.image(src="https://image.eveonline.com/Character/#{currentCharId}_64.jpg")
        else
          img.ui.avatar.image(src="/anon.jpg")
        span &nbsp;#{currentCharName}
        i.dropdown.icon
        .menu
          a.item
            i.user.icon
            span Profile
          a#settingsButton.item
            i.settings.icon
            span Settings
          a.item
            i.log.out.icon
            span Log out

//- Dashboard Sidebar
template(name="sidebar")
  .item.header MENU
  .item
    .header Misc
    .menu
      a.item Lorem
  .item
    .header Tools
    .menu
      a.item Ipsum
      a.item Dolor
      a.item Sit
      a.item Amet

//- ---------- -//
//-   ROUTES   -//
//- ---------- -//

//- Home
template(name="home")
  main.ui.fluid.two.column.stackable.grid
    .ui.seven.wide.column
      .ui.raised.olive.inverted.segment
        .ui.two.column.grid
          .column
            h2.ui.header API Keys
        .ui.section.segment
          h3.ui.header Add a key
          +insertKeyForm
        .ui.section.segment
          h3.ui.header Validate all keys
          button.validate-button Validate

    .ui.nine.wide.column
      #active-errors.ui.raised.red.inverted.segment
        .ui.one.column.grid
          .column
            h2.ui.header Active Errors
        .ui.section.segment
          .ui.accordion
            each errors
              .title
                .ui.grid
                  .twelve.wide.column
                    i.dropdown.icon
                    | Key ##{keyID} #[span(style="color: #ff0000") ({{keyErrorCount log}})]
                  .right.aligned.four.wide.column 
                    .ui.icon.button.circular.red.rm-err
                      i.remove.icon.white
              .content
                .ui.cards.olive
                  each errorMessage in log
                    .card
                      .content
                        .header
                          | {{prettyDate errorMessage.createdAt}}
                        .meta
                          | {{timeAgo errorMessage.createdAt}}
                          .right.floated
                            .ui.horizontal.red.label
                              | #{errorMessage.errorType}
                        .description
                          | #{errorMessage.message}
              .ui.divider

//- insertKeyForm
template(name="insertKeyForm")
  //- See https://github.com/aldeed/meteor-autoform#component-and-helper-reference for info on attributes used here
  +autoForm schema="AddKeyFormSchema" collection="Keys" id="insertKeyForm" type="method" meteormethod="addKeySubmit" validation="none" resetOnSuccess="true"
    .ui.fluid.input
      +afFieldInput name="keyID" type="text" placeholder="Key ID"
    {{afFieldMessage name="keyID"}}
    .ui.fluid.input
      +afFieldInput name="vCode" type="text" placeholder="Verification Code"
    {{afFieldMessage name="vCode"}}
    button(type="submit" class="ui fluid button") Add Key
